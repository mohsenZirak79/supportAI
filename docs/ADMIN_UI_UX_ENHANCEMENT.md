# راهنمای بهبود UI/UX پنل ادمین و نقش‌ها (به سبک پروژه Vote)

> **هدف:** مدرن، زیبا و حرفه‌ای کردن پنل مدیریت و پنل‌های سایر نقش‌ها (به‌جز پنل چت کاربر عادی)، با الهام از پروژه **Vote** (سامانه انتخابات الکترونیکی).
>
> **مهم:** رنگ اصلی و اکسنت پروژه خودتان (**Support AI**) حفظ شود؛ فقط الگوی چیدمان، فاصله‌ها، سایه و کامپوننت‌ها از Vote الهام گرفته می‌شوند. رنگ‌های فعلی پنل (`--admin-primary`, `--admin-accent` و …) تغییر نکنند.

---

## ۱. خلاصه الگوهای پروژه Vote (مرجع)

### ۱.۱ فناوری و ساختار
- **فریم‌ورک:** Next.js (App Router) + React + TypeScript
- **استایل:** Tailwind CSS با توکن‌های طراحی سفارشی
- **انیمیشن:** Framer Motion برای ورود/خروج و تعاملات
- **آیکون:** Lucide React
- **فونت:** Vazir، RTL، `lang="fa"` و `dir="rtl"`

### ۱.۲ طراحی (Design System)
- **رنگ در Vote (فقط مرجع):** در Vote از آبی (`#3366FF`) استفاده شده است. **در Support AI رنگ‌های خود پروژه حفظ شوند:** همان `--admin-primary`، `--admin-accent`، `--admin-accent-soft` و `--admin-primary-contrast` که در `master.blade.php` تعریف شده‌اند (primary تیره، اکسنت فیروزه‌ای #22d3ee). هیچ‌جا رنگ اصلی پروژه را به آبی Vote عوض نکنید.
- **پس‌زمینه:** سفید و پس‌زمینه ملایم (مثلاً همان `--admin-bg`)؛ گرادیان‌های ملایم برای عمق
- **سایه:** سایه‌های نرم مشابه Vote؛ می‌توان با رنگ primary/accent خودتان تنظیم کرد
- **گوشه‌ها:** `rounded-xl` (12px)، `rounded-2xl` (16px)
- **فاصله‌ها:** یکنواخت با `gap-6`، `p-6`، `p-8`

### ۱.۳ چیدمان (Layout)
- **سایدبار ثابت (راست):** عرض ۲۵۶px، پس‌زمینه گرادیان ملایم، border و سایه نرم
- **لگو و برند:** آیکون در باکس گرادیان، عنوان + زیرعنوان
- **نوار بالا (Header):** ثابت، شفاف با backdrop-blur، آواتار کاربر + منوی dropdown (داشبورد، خروج)
- **منوی موبایل:** دکمه همبرگر، overlay برای بستن، انیمیشن باز/بسته
- **محتوا:** `max-w-7xl mx-auto`، padding یکنواخت

### ۱.۴ صفحات و کامپوننت‌ها
- **داشبورد:** کارت‌های آمار رنگی با آیکون و لینک، چارت‌ها در کارت سفید با border، عملیات سریع به صورت دکمه‌های گرادیان، لیست فعالیت اخیر با pagination
- **لیست‌ها (مثلاً کاربران):** عنوان صفحه + توضیح، دکمه‌های اصلی (افزودن، بارگذاری)، جدول تمیز با hover، وضعیت با badge رنگی، منوی عملیات (⋯) با موقعیت پویا، PaginationBar یکسان
- **مودال‌ها:** پس‌زمینه شفاف، کارت `rounded-2xl`، دکمه بستن واضح، فرم با label و input یکدست، دکمه‌های اصلی/ثانویه
- **حالت بارگذاری:** LoadingSpinner و LoadingState با اندازه و متن قابل تنظیم
- **خطا:** باکس `bg-error/10` و `border-error/20` با متن قرمز

### ۱.۵ UX
- نقش‌ها و دسترسی: چک کردن نقش قبل از رندر؛ در صورت عدم دسترسی، صفحه «دسترسی غیرمجاز» با لینک بازگشت به پنل مناسب
- هیدراتاسیون احراز هویت قبل از نمایش layout برای جلوگیری از فلش
- RTL کامل و دکمه‌های قبلی/بعدی با آیکون مناسب جهت
- تأیید عملیات حساس (مثلاً غیرفعال‌سازی) با SweetAlert/confirm
- پیام موفقیت/خطا پس از عملیات

---

## ۲. وضعیت فعلی پنل Support AI

- **Layout:** Blade + یک navbar افقی در بالا + منوی لینک‌ها در navbar؛ بدون سایدبار جدا؛ فوتر ساده
- **استایل:** CSS سفارشی با متغیرها (--admin-primary و ...) + وابستگی به فایل‌های Soft UI (Bootstrap) در برخی صفحات
- **صفحات:** dashboard ساده (یک کارت خوش‌آمد)، users و roles با جدول و مودال، tickets و chats با DataTables/جدول و مودال Bootstrap
- **مشکلات:** ناهمگونی بین صفحات (بعضی Soft UI، بعضی استایل دستی)، عدم طراحی سیستم‌اتیک، موبایل ضعیف‌تر، کمبود loading/empty state یکسان، بدون انیمیشن ورود

---

## ۳. چک‌لیست بهبود (به ترتیب پیشنهادی)

### فاز ۱: پایهٔ طراحی و Layout ✅ (انجام شد)

- [x] **۱.۱ طراحی سیستم رنگ و فونت**
  - [x] **حفظ رنگ اصلی پروژه:** از همان `--admin-primary`، `--admin-accent`، `--admin-primary-contrast` و `--admin-accent-soft` استفاده شود؛ رنگ primary/accent را عوض نکنید.
  - [x] تعریف یا یکسان‌سازی فقط توکن‌های کمکی (text, text-secondary, success, error, warning, border) در یک فایل (مثلاً `admin.css` یا Tailwind config)، بدون تغییر primary/accent.
  - [x] استفاده از فونت Vazir (یا Vazirmatn) برای کل پنل و اطمینان از RTL.

- [x] **۱.۲ Layout اصلی (سایدبار + هدر)**
  - [x] ساخت layout با **سایدبار ثابت سمت راست** (مشابه Vote): عرض حدود ۲۵۶px، پس‌زمینه گرادیان ملایم، border و سایه.
  - [x] در سایدبار: لوگو/آیکون در باکس گرادیان، عنوان «پنل مدیریت»، زیرعنوان، لیست لینک‌های منو با آیکون و حالت active (پس‌زمینه **primary خود پروژه** یعنی `--admin-primary` و متن `--admin-primary-contrast`).
  - [x] هدر ثابت بالا: در سمت چپ (در RTL) دکمه منو برای موبایل؛ در سمت راست آواتار + نام کاربر + dropdown (داشبورد، خروج).
  - [x] نوتیفیکیشن در هدر با badge تعداد و dropdown لیست (بدون حذف منطق فعلی، فقط ظاهر یکدست).
  - [x] overlay برای موبایل هنگام باز بودن منو و بستن منو با کلیک بیرون.

- [x] **۱.۳ فوتر و محتوای اصلی**
  - [x] ناحیه محتوا با `max-width` و padding یکنواخت؛ حذف یا ساده‌سازی فوتر به یک خط (نام سیستم، لینک خروج).

- [x] **۱.۴ منوی نقش‌ها**
  - [x] آیتم‌های منو بر اساس permission (مثلاً read-ticket، read-chat، read-user، read-role) نمایش داده شوند (همان منطق فعلی در Blade).
  - [x] آیکون برای هر آیتم (داشبورد، کاربران، نقش‌ها، تیکت‌ها، گفت‌وگوها، پروفایل).

---

### فاز ۲: داشبورد ✅ (انجام شد)

- [x] **۲.۱ کارت‌های آمار**
  - [x] چند کارت آمار (تیکت کل، در انتظار پاسخ، گفت‌وگوها، ارجاع‌های باز، کاربران برای ادمین).
  - [x] هر کارت: آیکون رنگی در باکس گرادیان، عدد بزرگ، عنوان، زیرعنوان؛ کلیک منجر به رفتن به صفحه مربوطه.
  - [x] برای رنگ کارت‌ها از **پالت خود پروژه** استفاده شده (`--admin-primary`، `--admin-accent` و گرادیان‌های هماهنگ).
  - [x] استایل یکسان: پس‌زمینه سفید، border ملایم، `rounded-2xl`، سایه نرم و hover.

- [x] **۲.۲ عملیات سریع**
  - [x] دکمه‌های گرادیان برای «مشاهده تیکت‌ها»، «گفت‌وگوها»، «کاربران»، «نقش‌ها» (برای ادمین).
  - [x] هر دکمه: آیکون، عنوان، توضیح کوتاه، انیمیشن hover (translateY و سایه).

- [x] **۲.۳ فعالیت اخیر (اختیاری)**
  - [x] لیست «تیکت‌های اخیر» با لینک به جزئیات هر تیکت (عنوان، فرستنده، وضعیت، زمان).

- [x] **۲.۴ حذف المان‌های اضافی**
  - [x] حذف Fixed Plugin (تنظیمات Soft UI) از داشبورد.

---

### فاز ۳: لیست‌ها (کاربران، نقش‌ها، تیکت‌ها، گفت‌وگوها) ✅ (انجام شد)

- [x] **۳.۱ ساختار یکسان هر صفحه لیست**
  - [x] بالای صفحه: عنوان (h1)، توضیح کوتاه (متن secondary).
  - [x] دکمه‌های اصلی سمت راست (مثلاً «افزودن کاربر»، «افزودن نقش») با استایل primary و secondary (border).
  - [x] یک کارت/باکس سفید با border و `rounded-2xl` که جدول داخل آن است (کلاس‌های `.list-page`, `.list-page__card` در admin.css).

- [x] **۳.۲ جدول**
  - [x] thead با border-bottom و فونت semibold؛ سلول‌ها padding یکنواخت (py-4 px-4).
  - [x] tbody: هر سطر hover؛ border-bottom ملایم (کلاس `.list-page__table`).
  - [x] ستون وضعیت: badge گرد با رنگ (pending: نارنجی، answered: سبز، closed: خاکستری) — کلاس‌های `status-badge--*`.
  - [x] ستون عملیات: دکمه «مشاهده» و دکمه‌های «ویرایش»/«حذف» با استایل یکسان (`list-page__btn-view`, `list-page__btn-action--edit/delete`).

- [x] **۳.۳ Pagination**
  - [x] پارشیال `admin/partials/pagination.blade.php`: «قبلی» / «بعدی»، «نمایش X تا Y از Z»، «صفحه N از M».
  - [x] دکمه‌های غیرفعال با opacity و cursor-not-allowed (استفاده در tickets و chats).

- [x] **۳.۴ حالت خالی و بارگذاری**
  - [x] وقتی داده‌ای نیست: متن «هیچ موردی یافت نشد» در مرکز با `@forelse` و سلول colspan (`list-page__empty`).
  - [x] هنگام لود مودال: متن «در حال بارگذاری…» داخل مودال تیکت/چت (منطق قبلی حفظ شده).

---

### فاز ۴: مودال‌ها و فرم‌ها ✅ (انجام شد)

- [x] **۴.۱ مودال یکسان**
  - [x] پس‌زمینه overlay شفاف (`rgba(15, 23, 42, 0.35)`) در `admin.css` برای `.modal-backdrop`.
  - [x] محتوا در کارت با `border-radius: 1rem`، سایه و max-width (کلاس‌های `.admin-modal .modal-content`، `.modal-dialog`).
  - [x] هدر مودال: عنوان (`.modal-title`) + دکمه بستن (`.btn-close`) با hover.
  - [x] بدنه: padding و فونت یکدست (`.admin-modal .modal-body`). همه مودال‌های ادمین کلاس `admin-modal` دارند.

- [x] **۴.۲ فرم‌ها**
  - [x] هر فیلد: label با `.form-label` (font-weight 500)؛ input با `.form-control` / `.form-select` (border ملایم، `rounded-lg`)؛ در صورت خطا `.is-invalid` و `.invalid-feedback` (border قرمز و متن قرمز زیر فیلد). فرم‌ها کلاس `admin-form` دارند.
  - [x] دکمه‌ها: `.admin-btn--primary` و `.admin-btn--secondary`. در حالت loading کلاس `is-loading` و متن «در حال ذخیره...» از طریق اسکریپت در `master.blade.php` (فرم‌های غیر AJAX). فرم‌های AJAX با `data-ajax-form="1"` از loading خودشان استفاده می‌کنند.

- [x] **۴.۳ تاریخ شمسی**
  - [x] Jalali DatePicker در فرم کاربران و پروفایل با کلاس `input-jalali` و استایل هماهنگ؛ `z-index: 201000` برای `.jdp-container` در `admin.css` تا بالای مودال باشد. در `shown.bs.modal` گزینه‌های datepicker با z-index به‌روز می‌شوند.

---

### فاز ۵: صفحات جزئیات (تیکت، گفت‌وگو) ✅ (انجام شد)

- [x] **۵.۱ تیکت**
  - [x] مودال جزئیات: عنوان تیکت، متا (ارسال‌کننده، تاریخ، وضعیت) در کارت `.detail-meta` با عنوان و سطرهای متا.
  - [x] لیست پیام‌ها: هر پیام در حباب `.detail-bubble--user` (آبی ملایم) یا `.detail-bubble--agent` (سبز ملایم) با جهت متفاوت (justify-content-start/end).
  - [x] پیوست‌ها: لینک با آیکون و نام فایل در `.detail-attachments` / `.detail-attachment-link` زیر هر پیام.
  - [x] فرم پاسخ: textarea + انتخاب فایل و دکمه «ثبت پاسخ»؛ فقط وقتی `can_reply` نمایش داده می‌شود.
  - [x] پس از ثبت پاسخ: toast موفقیت و به‌روزرسانی لیست پیام‌ها با فراخوانی مجدد `renderDetails` بدون رفرش صفحه.

- [x] **۵.۲ گفت‌وگو (چت)**
  - [x] لیست مکالمات در جدول با عنوان، کاربر، تاریخ و دکمه «مشاهده» (ساختار فاز ۳).
  - [x] مودال جزئیات: کارت متا `.detail-meta` (عنوان مکالمه، کاربر)؛ لیست پیام‌ها با حباب‌های user/ai (`.detail-bubble--user` / `--agent`) و رسانه (صوت با voice-card، فایل با `.detail-attachment-link`)؛ لیست ارجاع‌ها در کارت‌های `.detail-referral-card` با وضعیت و فرم «پاسخ» و در صورت نیاز «تخصیص به من».
  - [x] فرم پاسخ به ارجاع و آپلود فایل با کلاس `admin-form` و `admin-btn` (همان استایل فاز ۴).

---

### فاز ۶: تجربه کاربری و دسترسی ✅ (شروع / انجام شد)

- [x] **۶.۱ بارگذاری و خطا**
  - [x] در درخواست‌های fetch جزئیات تیکت/چت: حالت loading («در حال بارگذاری…») و در صورت خطا باکس `.admin-error-box` با پیام و دکمه «تلاش مجدد» (`.admin-retry-btn`). دکمه‌های ارسال فرم در AJAX غیرفعال و متن «در حال ثبت...» (تیکت/ارجاع).
  - [x] باکس خطا با استایل قرمز ملایم و دکمه تلاش مجدد در `admin.css`؛ در مودال تیکت و چت هنگام خطای بارگذاری نمایش داده می‌شود.

- [x] **۶.۲ تأیید عملیات**
  - [x] مودال تأیید یکسان (`admin/partials/confirm-modal.blade.php`) با عنوان، متن و دکمه‌های «انصراف» و «بله، حذف شود». دکمه‌های حذف کاربر/نقش با `data-confirm-form` و `data-confirm-body`/`data-confirm-title`؛ کلیک روی حذف مودال را باز می‌کند و پس از تأیید فرم ارسال می‌شود.

- [x] **۶.۳ دسترسی (Accessibility)**
  - [x] دکمه باز/بست منو و منوی کاربر با `aria-label`؛ دکمه‌های ویرایش/حذف با `aria-label` مناسب؛ مودال‌ها با `aria-labelledby` و دکمه بستن با `aria-label="بستن"`. Bootstrap مودال‌ها با focus trap و بستن با Escape.
  - [x] رنگ‌ها با توکن‌های پروژه (`--admin-text` روی `--admin-surface` و پس‌زمینه‌های ملایم) برای تضاد قابل قبول.

- [x] **۶.۴ موبایل**
  - [x] سایدبار در موبایل کشویی با دکمه همبرگر و overlay (فاز ۱). جداول با `.table-responsive` برای اسکرول افقی.
  - [x] دکمه‌های اصلی و عملیات با `min-height: 44px` و padding مناسب در رسانه `max-width: 768px` برای لمس راحت.

---

### فاز ۷: یکپارچگی و تمیزکاری ✅ (انجام شد)

- [x] **۷.۱ حذف وابستگی‌های غیرضروری**
  - [x] حذف Fixed Plugin (Soft UI Configurator) از صفحه پروفایل؛ قبلاً از داشبورد، کاربران، نقش‌ها و گفت‌وگوها حذف شده بود.
  - [x] استایل‌های پنل با `admin.css` و توکن‌های طراحی (`--admin-*`) یکپارچه شده‌اند؛ Bootstrap فقط برای گرید (row/col)، مودال و dropdown در صورت نیاز استفاده می‌شود و ظاهر با CSS سفارشی override شده است.

- [x] **۷.۲ یکسان‌سازی نوتیفیکیشن**
  - [x] در کل پنل ادمین از `window.toast` (Toastify در `admin.js`) برای موفقیت/خطا استفاده می‌شود.
  - [x] پس از ریدایرکت با `session('success')` یا `session('error')`، پیام در همان مودال toast نمایش داده می‌شود (در `master.blade.php` با `window.__adminFlash` و فراخوانی `toast.success`/`toast.error`).

- [x] **۷.۳ پروفایل ادمین**
  - [x] صفحه پروفایل با همان ساختار layout (`.list-page`, `.list-page__header`, `.list-page__card`) و کارت سفید با border و rounded؛ عنوان «پروفایل» و زیرعنوان؛ فرم ویرایش و فیلد تغییر رمز با کلاس‌های `admin-form` و `admin-btn` (همان استایل فاز ۴). خطاهای اعتبارسنجی در باکس `.admin-error-box` نمایش داده می‌شوند.

---

## ۴. گزینه‌های پیاده‌سازی

### گزینه A: بهبود در همین پشته (Blade + CSS/JS)
- Layout جدید با HTML/CSS (یا Tailwind از طریق CDN/Vite) و سایدبار + هدر.
- جداول و مودال‌ها با همان Blade و JavaScript vanilla یا Alpine.js؛ استایل مطابق چک‌لیست.
- **مزیت:** بدون تغییر معماری؛ **معایب:** تعاملات پیشرفته و انیمیشن محدودتر.

### گزینه B: Tailwind + Vite در همان پروژه Laravel
- نصب Tailwind و Vite برای پنل؛ تعریف design tokens در `tailwind.config.js`.
- ساخت کامپوننت‌های Blade قابل استفاده مجدد (مثلاً `@include('admin.components.card')`) یا استفاده از Alpine برای dropdown و مودال.
- **مزیت:** ظاهر بسیار نزدیک به Vote با تلاش کمتر برای یکدستی.

### گزینه C: SPA جدا (Vue/React) برای پنل
- یک اپ جدا (مثلاً Vue 3 یا React) فقط برای مسیرهای `/admin/*` که از API Laravel استفاده می‌کند.
- Layout و کامپوننت‌ها دقیقاً شبیه Vote (سایدبار، کارت، جدول، مودال، pagination).
- **مزیت:** UX و انیمیشن در سطح Vote؛ **معایب:** نیاز به لاگین و session/JWT برای SPA و نگهداری دو فرانت.

---

## ۵. اولویت پیشنهادی

1. **فاز ۱** (Layout و طراحی پایه) را حتماً اول انجام دهید تا بقیه صفحات روی یک پایه یکسان ساخته شوند.
2. سپس **فاز ۲** (داشبورد) و **فاز ۳** (لیست‌ها) برای بیشترین تأثیر بصری.
3. بعد **فاز ۴ و ۵** (مودال، فرم، جزئیات تیکت/چت).
4. در نهایت **فاز ۶ و ۷** (UX، دسترسی، تمیزکاری).

---

## ۶. ارجاعات سریع به پروژه Vote

| مورد | مسیر در پروژه Vote |
|------|---------------------|
| Layout ادمین (سایدبار + هدر) | `frontend/app/admin/layout.tsx` |
| داشبورد | `frontend/app/admin/dashboard/page.tsx` |
| صفحه کاربران (جدول + مودال) | `frontend/app/admin/users/page.tsx` |
| طراحی گلوبال و RTL | `frontend/app/globals.css` |
| توکن‌های رنگ و سایه | `frontend/tailwind.config.ts` |
| اسپینر و حالت بارگذاری | `frontend/components/ui/loading-spinner.tsx` |
| Pagination | `frontend/components/ui/pagination-bar.tsx` |
| Layout مشترک پنل (سوپروایزر) | `frontend/components/panel/PanelLayout.tsx` |

با انجام این چک‌لیست به ترتیب، پنل ادمین و نقش‌های دیگر به لحاظ ظاهر و تجربه کاربری به سطح پروژه Vote نزدیک می‌شوند.
